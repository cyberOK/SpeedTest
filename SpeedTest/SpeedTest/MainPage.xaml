<Page
    x:Class="SpeedTest.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:SpeedTest"
    xmlns:vm="using:SpeedTest.ViewModel" 
    xmlns:arcControl="using:SpeedTest.ArcControl"
    xmlns:converter="using:SpeedTest.ViewModel.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:Interactivity="using:Microsoft.Xaml.Interactivity"
    xmlns:Core="using:Microsoft.Xaml.Interactions.Core"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Page.DataContext>
        <vm:MainPageViewModel/>
    </Page.DataContext>

    <Page.Resources>
        <converter:RadioModeSelectedIntToBooltConverter x:Key="RadioModeSelectedIntToBooltConverter"/>

        <ControlTemplate TargetType="Button" x:Key="btTemplate">
            <Border CornerRadius="200" BorderBrush="CadetBlue" BorderThickness="3" Height="400" Width="400" >
                <ContentPresenter  HorizontalAlignment="Center" VerticalAlignment="Center" Content="Start" Height="120"/>
            </Border>
        </ControlTemplate>
    </Page.Resources>

    <Grid  Background="#FFCFE6E6">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="0.4*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.1*"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="0.1*"/>
        </Grid.ColumnDefinitions>

        <!-- Arc Control -->
        <arcControl:Arc Grid.Column="1" Fill="DarkCyan" Thickness="30" Radius="200" PercentValue="215"/>
        <arcControl:Arc Grid.Column="1" Fill="Gray" Thickness="30" Radius="200" PercentValue="400" Opacity="0.4"/>
        <arcControl:Arc Grid.Column="1" Fill="DarkBlue" Thickness="30" Radius="171" PercentValue="97"/>
        <arcControl:Arc Grid.Column="1" Fill="Gray" Thickness="30" Radius="171" PercentValue="400" Opacity="0.2"/>

        <!-- Settings Panel Buttons -->
        <StackPanel Grid.Column="2" HorizontalAlignment="Center" Margin="0,50">
            <Button x:Name="setingsButton" 
                Background="Transparent"
                FontFamily="Segoe MDL2 Assets" 
                FontSize="36"                
                Content="&#xE713;" 
                Command="{Binding SettingsButtonPressed}"/>
            <Button x:Name="historyButton" 
                Background="Transparent"
                FontFamily="Segoe MDL2 Assets" 
                FontSize="36"                
                Content="&#xE81C;" 
                Command="{Binding HistoryButtonPressed}"/>
            <Button x:Name="backButton" 
                Background="Transparent"
                FontFamily="Segoe MDL2 Assets" 
                FontSize="36"                
                Content="&#xE72D;"
                Command="{Binding BackButtonPressed}"/>
        </StackPanel>

        <!-- Start Button -->
        <Button x:Name="startButton" 
                Template="{StaticResource btTemplate}" 
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Grid.Column="1" FontSize="80"
                Command="{Binding StartButtonPressed}"/>

        <!-- Split Line -->
        <Grid Grid.Column="1" Grid.Row="1" HorizontalAlignment="Center" Width="1000" Margin="0,0,0,307">
            <Line Grid.Column="1" Grid.Row="1" HorizontalAlignment="Left" VerticalAlignment="Top" StrokeThickness="3" X1="0"  X2="499">
                <Line.Stroke>
                    <LinearGradientBrush StartPoint="0,0.5" EndPoint="0.8,1" ColorInterpolationMode="ScRgbLinearInterpolation">
                        <GradientStop Color="#FFBDEAEC" Offset="0" />
                        <GradientStop Color="#FF104364" Offset="1" />
                    </LinearGradientBrush>
                </Line.Stroke>
            </Line>

            <Line Grid.Column="1" Grid.Row="1" HorizontalAlignment="Right" VerticalAlignment="Top" StrokeThickness="3" X1="0"  X2="499">
                <Line.Stroke>
                    <LinearGradientBrush StartPoint="0.1,1" EndPoint="0.8,1" ColorInterpolationMode="ScRgbLinearInterpolation">
                        <GradientStop Color="#FFBDEAEC" Offset="1" />
                        <GradientStop Color="#FF104364" Offset="0" />
                    </LinearGradientBrush>
                </Line.Stroke>
            </Line>
        </Grid>

        <!-- Main Board -->
        <RelativePanel Grid.Column="1" Grid.Row="1" Width="600">
            <TextBlock x:Name="providerName"
                       Width="300"
                       Height="60"
                       FontSize="30"
                       Text="{Binding ProviderName}"
                       TextAlignment="Center"
                       RelativePanel.AlignLeftWithPanel="True"/>
            <TextBlock x:Name="ipAdress"
                       Width="300"
                       Height="60"
                       FontSize="30"
                       Text="{Binding IpAdress}"
                       TextAlignment="Center"                       
                       RelativePanel.Below="providerName"/>
            <TextBlock x:Name="serverName"
                       Width="300"
                       Height="60"
                       FontSize="30"
                       Text="{Binding ServerName}"
                       TextAlignment="Center"
                       RelativePanel.RightOf="providerName"/>
            <TextBlock x:Name="serverLocation"
                       Width="300"
                       Height="60"
                       FontSize="30"
                       Text="{Binding ServerLocation}"
                       TextAlignment="Center"
                       RelativePanel.Below="serverName"
                       RelativePanel.RightOf="ipAdress"/>
            <Button x:Name="changeServerButton"
                    Width="300"
                    Height="60"
                    FontSize="30"
                    Content="Change server"
                    RelativePanel.Below="serverLocation"
                    RelativePanel.RightOf="providerName" 
                    Foreground="White" 
                    FontWeight="Normal"
                    Opacity="1"
                    Command="{Binding ChangeServerButtonPressed}">
                <Button.Background>
                    <LinearGradientBrush EndPoint="0,1" StartPoint="0.6,0">
                        <GradientStop Color="#FF14CEEC" Offset="1"/>
                        <GradientStop Color="#FF101757" Offset="0"/>
                    </LinearGradientBrush>
                </Button.Background>
            </Button>
        </RelativePanel>

        <!-- Settings Panel -->
        <SplitView x:Name="SettingSplitView" 
                   IsPaneOpen="{Binding IsSettingsPaneOpen}" 
                   FlowDirection="RightToLeft"                    
                   OpenPaneLength="450" Grid.Column="1" 
                   Margin="1263,50,50,155" 
                   Grid.RowSpan="2"
                   Grid.ColumnSpan="2" HorizontalAlignment="Right" VerticalAlignment="Stretch">

            <Interactivity:Interaction.Behaviors>
                <Core:EventTriggerBehavior EventName="PaneClosing">
                    <Core:InvokeCommandAction Command="{Binding SettingSplitViewClosing}"/>
                </Core:EventTriggerBehavior>
            </Interactivity:Interaction.Behaviors>

            <SplitView.Pane>
                <Grid>
                    <RelativePanel HorizontalAlignment="Left" VerticalAlignment="Stretch">

                        <RelativePanel x:Name="SettingsPanel" Background="White" Width="450" IsHoldingEnabled="True" HorizontalAlignment="Stretch" 
                                       VerticalAlignment="Stretch" FlowDirection="RightToLeft">
                            <TextBlock x:Name="SettingsBlock" Text="Settings" FontSize="30" Foreground="DarkCyan"  Padding="40,10"
                                       RelativePanel.AlignRightWithPanel="True" Margin="30,0,0,0"/>
                            <Button x:Name="CloseSettingButton" Command="{Binding SettingSplitViewClosing}" Height="60" Width="60" Background="Transparent" 
                                    Foreground="DarkCyan" FontSize="30" FontFamily="Segoe MDL2 Assets" Content="&#xE711;" RelativePanel.AlignLeftWithPanel="True"/>
                        </RelativePanel>

                        <ListView  Margin="-30,0,0,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" RelativePanel.Below="SettingsPanel">
                            <ScrollViewer x:Name="ScrollForSettings" ScrollViewer.IsVerticalRailEnabled="True" VerticalScrollBarVisibility="Auto">
                                <RelativePanel x:Name="ContentPanel"  Background="LightGray" Width="454" >
                                    <TextBlock x:Name="LanguageBlock" Text="Language" FontSize="20" Padding="30,10" TextAlignment="Left" HorizontalAlignment="Left" 
                                               RelativePanel.AlignRightWithPanel="True"/>
                                    <ComboBox x:Name="LanguageComboBox" ItemsSource="{Binding Settings.Languages}" PlaceholderText="English" Width="320" Margin="30,0" 
                                              HorizontalContentAlignment="Left" FlowDirection="LeftToRight" RelativePanel.Below="LanguageBlock" RelativePanel.AlignRightWithPanel="True">

                                        <Interactivity:Interaction.Behaviors>
                                            <Core:EventTriggerBehavior EventName="SelectionChanged">
                                                <Core:InvokeCommandAction Command="{Binding LanguageComboBoxChanged}" 
                                                                          CommandParameter="{Binding ElementName=LanguageComboBox,Path=SelectedItem}"/>
                                            </Core:EventTriggerBehavior>
                                        </Interactivity:Interaction.Behaviors>

                                        <ComboBoxItem x:Name="EnglixhComboBoxItem"></ComboBoxItem>
                                        <ComboBoxItem x:Name="RussianComboBoxItem"></ComboBoxItem>
                                    </ComboBox>

                                    <TextBlock x:Name="ModeBlock" Text="Mode" FontSize="30" Foreground="DarkCyan" Padding="30,10" TextAlignment="Right"
                                               RelativePanel.Below="LanguageComboBox" RelativePanel.AlignRightWithPanel="True"/>
                                    <RadioButton x:Name="LightRadioButton" GroupName="Theme"  Content="Light" 
                                                 Command="{Binding SelectedItemRadioButtonChanged}" CommandParameter="{Binding ElementName=LightRadioButton,Path=Content}" 
                                                 IsChecked="{Binding SelectedMode, Converter={StaticResource RadioModeSelectedIntToBooltConverter}, ConverterParameter = 0}"
                                                 Margin="0,0,-30,0" Width="90" RelativePanel.Below="ModeBlock" RelativePanel.AlignRightWithPanel="True"/>
                                    <RadioButton x:Name="DarkRadioButton" GroupName="Theme" Content="Dark" 
                                                 Command="{Binding SelectedItemRadioButtonChanged}" CommandParameter="{Binding ElementName=DarkRadioButton,Path=Content}" 
                                                 IsChecked="{Binding SelectedMode, Converter={StaticResource RadioModeSelectedIntToBooltConverter}, ConverterParameter = 1}"
                                                 Margin="0,0,-30,0" Width="90" RelativePanel.Below="LightRadioButton" RelativePanel.AlignRightWithPanel="True"/>

                                    <TextBlock x:Name="AboutBlock" Text="About" FontSize="30" Foreground="DarkCyan" Padding="30,10" TextAlignment="Right" 
                                               RelativePanel.Below="DarkRadioButton" RelativePanel.AlignRightWithPanel="True"/>
                                    <TextBlock x:Name="ProgramNameBlock" Text="{Binding Settings.ProgramName}" FontSize="15" Foreground="Gray"  Padding="0,00,30,0"
                                               TextAlignment="Right" RelativePanel.Below="AboutBlock" RelativePanel.AlignRightWithPanel="True"/>
                                    <TextBlock x:Name="VersionBlock" Text="{Binding Settings.Version}" FontSize="15" Foreground="Gray"  Padding="0,00,30,0" 
                                               TextAlignment="Right" RelativePanel.Below="ProgramNameBlock" RelativePanel.AlignRightWithPanel="True"/>
                                    <TextBlock x:Name="MicrosoftResearchBlock" Text="Microsoft Research" FontSize="15" Foreground="Gray"  Padding="0,00,30,0" 
                                               TextAlignment="Right" RelativePanel.Below="VersionBlock" RelativePanel.AlignRightWithPanel="True"/>
                                    <RichTextBlock x:Name="AboutStoryBlock" Margin="50,30,30,30" RelativePanel.Below="MicrosoftResearchBlock">
                                        <Paragraph   TextAlignment="Right">
                                            <Run Text="{Binding Settings.AboutArticle}"/>
                                        </Paragraph>
                                    </RichTextBlock>

                                    <HyperlinkButton  x:Name="FeedBackLink" NavigateUri="{Binding Settings.FeedBackLink}" HorizontalAlignment="Right" Margin="30,0"
                                                      FontSize="16" RelativePanel.Below="AboutStoryBlock" RelativePanel.AlignRightWithPanel="True">Feedback</HyperlinkButton>
                                    <HyperlinkButton x:Name="RateLink" NavigateUri="{Binding Settings.RateLink}" HorizontalAlignment="Right" Margin="30,0" FontSize="16"
                                                     RelativePanel.Below="FeedBackLink" RelativePanel.AlignRightWithPanel="True">Rate us</HyperlinkButton>
                                </RelativePanel>
                            </ScrollViewer>
                        </ListView>

                    </RelativePanel>
                </Grid>
            </SplitView.Pane>
        </SplitView>

        <!-- History Panel -->
        <!--Width="700" Height="700"
                   HorizontalAlignment="Center" Margin="0,175,0,238" Grid.RowSpan="2" VerticalAlignment="Stretch"-->
        <Grid Grid.Column="1"  Grid.RowSpan="2" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
            <RelativePanel Height="700" Width="700" Background="Aqua">

                <RelativePanel x:Name="HistoryPanel"  Background="White" IsHoldingEnabled="True" 
                               HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                               Width="700">
                    <TextBlock x:Name="HistoryBlock" Text="History" FontSize="30" Foreground="DarkCyan" Padding="30,10" 
                                       RelativePanel.AlignLeftWithPanel="True"/>
                    <Button x:Name="DeleteHistoryButton" Command="{Binding DeleteHistoryButton}" Height="60" Width="60"  Background="Transparent" 
                                    Foreground="DarkCyan" FontSize="30" FontFamily="Segoe MDL2 Assets" Content="&#xE74D;" RelativePanel.RightOf="HistoryBlock"/>
                    <Button x:Name="CloseHistoryButton" Command="{Binding CloseHistoryButton}" Height="60" Width="60" Background="Transparent" FontSize="30"
                                    Foreground="DarkCyan" FontFamily="Segoe MDL2 Assets" Content="&#xE711;" RelativePanel.AlignRightWithPanel="True"/>

                </RelativePanel>
            </RelativePanel>

        </Grid>
    </Grid>
</Page>
